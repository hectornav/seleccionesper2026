{% load static %}
<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Elecciones Per√∫ 2026{% endblock %}</title>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üó≥Ô∏è</text></svg>">
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/base.css' %}">
    {% block extra_css %}{% endblock %}
</head>

<body>
    <div class="flag-strip"></div>

    <!-- NAVBAR -->
    <nav class="navbar-peru">
        <div class="container">
            <div class="d-flex align-items-center justify-content-between w-100">
                <a href="{% url 'candidatos:home' %}" class="navbar-brand-custom">
                    <div class="brand-icon">üó≥Ô∏è</div>
                    <div class="brand-text">
                        <span class="brand-title">Elecciones Per√∫</span>
                        <span class="brand-subtitle">Generales 2026</span>
                    </div>
                </a>

                <button class="navbar-toggler-custom d-md-none" onclick="toggleMobileMenu()">
                    <i class="bi bi-list"></i>
                </button>

                <div class="d-none d-md-flex align-items-center gap-1" id="navMenu">
                    <a href="{% url 'candidatos:home' %}"
                        class="nav-link-custom {% if request.resolver_match.url_name == 'home' %}active{% endif %}">
                        <i class="bi bi-house"></i> Candidatos
                    </a>
                    <a href="{% url 'candidatos:comparar' %}"
                        class="nav-link-custom {% if request.resolver_match.url_name == 'comparar' %}active{% endif %}">
                        <i class="bi bi-columns-gap"></i> Comparar
                    </a>
                    <a href="{% url 'votacion:intencion' %}"
                        class="nav-link-custom {% if request.resolver_match.url_name == 'intencion' %}active{% endif %}">
                        <i class="bi bi-bar-chart"></i> Votos
                    </a>
                    <a href="#" class="nav-link-custom" data-bs-toggle="modal" data-bs-target="#modalEncuestas" id="btnEncuestas">
                        <i class="bi bi-graph-up-arrow"></i> Encuestas
                    </a>
                    <a href="{% url 'candidatos:sobre' %}"
                        class="nav-link-custom {% if request.resolver_match.url_name == 'sobre' %}active{% endif %}">
                        <i class="bi bi-info-circle"></i> Acerca de
                    </a>
                    <a href="{% url 'candidatos:quiz' %}" class="nav-link-custom btn-quiz-nav ms-2">
                        <i class="bi bi-lightning-fill"></i> Test Electoral
                    </a>
                </div>
            </div>

            <!-- Mobile Menu -->
            <div class="d-md-none w-100 mt-2 d-none" id="mobileMenu"
                style="border-top:1px solid rgba(255,255,255,0.12);padding-top:0.5rem">
                <div class="d-flex flex-column gap-1 pb-2">
                    <a href="{% url 'candidatos:home' %}" class="nav-link-custom">
                        <i class="bi bi-house"></i> Candidatos
                    </a>
                    <a href="{% url 'candidatos:comparar' %}" class="nav-link-custom">
                        <i class="bi bi-columns-gap"></i> Comparar Candidatos
                    </a>
                    <a href="{% url 'votacion:intencion' %}" class="nav-link-custom">
                        <i class="bi bi-bar-chart"></i> Intenci√≥n de Voto
                    </a>
                    <a href="#" class="nav-link-custom" data-bs-toggle="modal" data-bs-target="#modalEncuestas">
                        <i class="bi bi-graph-up-arrow"></i> Encuestas
                    </a>
                    <a href="{% url 'candidatos:sobre' %}" class="nav-link-custom">
                        <i class="bi bi-info-circle"></i> Acerca del Proyecto
                    </a>
                    <a href="{% url 'candidatos:quiz' %}" class="nav-link-custom btn-quiz-nav">
                        <i class="bi bi-lightning-fill"></i> Test Electoral
                    </a>
                </div>
            </div>
        </div>
    </nav>

    {% block content %}{% endblock %}

    <!-- Modal Encuestas (estad√≠sticas encuestadoras) -->
    <div class="modal fade" id="modalEncuestas" tabindex="-1" aria-labelledby="modalEncuestasLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-lg">
            <div class="modal-content">
                <div class="modal-header border-0 pb-0">
                    <h2 class="modal-title fw-bold" id="modalEncuestasLabel">
                        <i class="bi bi-graph-up-arrow text-primary"></i> Encuestas de intenci√≥n de voto
                    </h2>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body pt-2" id="modalEncuestasBody">
                    <div class="text-center py-4 text-muted" id="modalEncuestasLoading">
                        <div class="spinner-border text-primary" role="status"></div>
                        <p class="mt-2 mb-0 small">Cargando estad√≠sticas...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- FOOTER -->
    <footer class="footer">
        <div class="container">
            <div class="row g-4">
                <div class="col-md-4">
                    <div class="d-flex align-items-center gap-2 mb-2">
                        <span style="font-size:1.5rem">üó≥Ô∏è</span>
                        <span style="font-weight:700;color:white;font-size:1rem">Elecciones Per√∫ 2026</span>
                    </div>
                    <p style="font-size:0.82rem;line-height:1.6">
                        Plataforma ciudadana para informarse sobre los candidatos y tomar una decisi√≥n de voto informada
                        y consciente.
                    </p>
                </div>
                <div class="col-md-4">
                    <h6 style="color:white;font-weight:700;margin-bottom:0.75rem">Navegaci√≥n</h6>
                    <ul style="list-style:none;padding:0;margin:0;font-size:0.85rem">
                        <li class="mb-1"><a href="{% url 'candidatos:home' %}"><i class="bi bi-chevron-right"></i> Ver
                                candidatos</a></li>
                        <li class="mb-1"><a href="{% url 'candidatos:comparar' %}"><i class="bi bi-chevron-right"></i>
                                Comparar candidatos</a></li>
                        <li class="mb-1"><a href="{% url 'candidatos:quiz' %}"><i class="bi bi-chevron-right"></i> Test
                                electoral</a></li>
                        <li class="mb-1"><a href="{% url 'candidatos:sobre' %}"><i class="bi bi-chevron-right"></i>
                                Acerca del proyecto</a></li>
                    </ul>
                </div>
                <div class="col-md-4">
                    <h6 style="color:white;font-weight:700;margin-bottom:0.75rem">Aviso importante</h6>
                    <p style="font-size:0.8rem;line-height:1.6">
                        <i class="bi bi-exclamation-triangle text-warning"></i>
                        Esta plataforma es de car√°cter informativo y educativo. No tiene afiliaci√≥n pol√≠tica ni
                        promovemos a ning√∫n candidato en particular.
                    </p>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <div class="container">
                üáµüá™ Elecciones Per√∫ 2026 ‚Äî Plataforma Ciudadana &bull; Vota informado &bull;
                <a href="https://www.paypal.com/cgi-bin/webscr?cmd=_donations&business=hnavarrob39@gmail.com&item_name=Apoyo+a+Elecciones+Peru+2026&currency_code=USD"
                    target="_blank" rel="noopener"
                    style="color:rgba(255,255,255,0.6);text-decoration:none;font-size:0.75rem">
                    <i class="bi bi-cup-hot"></i> Invitar un caf√©
                </a>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{% static 'js/base.js' %}"></script>
    <script>
        (function() {
            var modalEl = document.getElementById('modalEncuestas');
            if (!modalEl) return;
            var bodyEl = document.getElementById('modalEncuestasBody');
            var loadingEl = document.getElementById('modalEncuestasLoading');
            var loaded = false;
            modalEl.addEventListener('show.bs.modal', function() {
                if (loaded) return;
                loaded = true;
                fetch('{% url "candidatos:encuestas_popup" %}')
                    .then(function(r) { return r.text(); })
                    .then(function(html) {
                        loadingEl.classList.add('d-none');
                        bodyEl.innerHTML = html;
                    })
                    .catch(function() {
                        loadingEl.innerHTML = '<p class="text-danger">No se pudieron cargar las encuestas.</p>';
                    });
            });
        })();
    </script>
    {% block extra_js %}{% endblock %}
</body>

</html>